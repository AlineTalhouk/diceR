#' Title function for computing classification accuracy for a clustering result
#'
#' @param labels : labels generated by classifier
#' @param truelabels : true labels for the observations
#'
#' @return classification accuracy score
#' @export
#'
#' @examples
#' valid_CA(c(4,4,4,4),c(4,2,4,4))
#' valid_CA(c(4,4,4,4,8),c(4,2,4,4,6))
valid_CA <- function(labels, truelabels) {
  assertthat::assert_that(is.vector(labels), is.vector(truelabels))
  nrow <- length(truelabels)
  C <- sort(unique(labels))
  k <- length(C)
  clusters <- list(NULL)
  for (i in 2:k) {
    clusters <- c(clusters, NULL)
  }
  ca <- 0
  for (i in 1:k) {
    ind <- which(labels == C[i])
    clusters[[i]] <- matrix(ind, ncol = 1)
    n <- length(ind)
    temp <- NULL
    for (j in 1:n) {
      temp <- append(temp, truelabels[ind[j]])
    }
    clusters[[i]] <- cbind(clusters[[i]], temp)
    TC <- sort(unique(clusters[[i]][, 2]))
    kTC <- length(TC)
    ind <- NULL
    for (l in 1:kTC) {
      ind <- append(ind, length(which(clusters[[i]][, 2] == TC[l])))
    }
    M <- max(ind)
    I <- which(ind == M)
    ca <- ca + M
  }
  return(ca / nrow)
}

#' Title function to calculate Rand indices to compare two partitions
#'
#' @param c1 : vector listing class membership
#' @param c2 : another vector listing class membership
#'
#' @return AR: adjusted Rand index, RI: unadjusted Rand index, MI: Mirkin's index, HI: Hubert's index
#' @export
#'
#' @examples
#' data("E")
#' valid_RandIndex(E[,1],E[,2])
valid_RandIndex <- function(c1, c2) {
  assertthat::assert_that(is.vector(c1))
  assertthat::assert_that(is.vector(c2))
  C <- table(c1, c2)
  n <- sum(C)
  nis <- sum(rowSums(C) ^ 2)
  njs <- sum(colSums(C) ^ 2)
  t1 <- n * (n - 1) / 2
  t2 <- sum(C ^ 2)
  t3 <- 0.5 * (nis + njs)
  nc <- (n * (n ^ 2 + 1) - (n + 1) * nis - (n + 1) * njs + 2 * (nis * njs) /
           n) / (2 * (n - 1))
  A <- t1 + t2 - t3
  D <- t3 - t2
  if (t1 == nc) {
    AR <- 0
  } else{
    AR <- (A - nc) / (t1 - nc)
  }
  RI <- A / t1
  MI <- D / t1
  HI <- (A - D) / t1
  return(list(
    AR = AR,
    RI = RI,
    MI = MI,
    HI = HI
  ))
}
