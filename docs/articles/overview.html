<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cluster Analysis using <code>diceR</code> • diceR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">diceR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AlineTalhouk/diceR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Cluster Analysis using <code>diceR</code>
</h1>
                        <h4 class="author">Derek Chiu</h4>
            
            <h4 class="date">2017-03-08</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h2>
<p>Cluster analysis is a way of “slicing and dicing” data such that we group together similar entities and separate dissimilar ones. The trouble is that there is a diverse number of clustering algorithms, each with different techniques and inputs. Thus, an automated cluster analysis pipeline is not feasible. Our approach is to use cluster ensembles from a diverse set of algorithms so that the final class labels are obtained after considering a variety of methods. We currently implement about 15 clustering algorithms. Although the results are relatively dependent on the subset of algorithms chosen for the ensemble, the intent is that we capture a variety of clustering ideologies and reach a consensus class.</p>
<p><code>diceR</code> is currently only available on GitHub (<em>the second line below will be uncommented once the repository becomes public</em>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
<span class="co"># devtools::install_github("AlineTalhouk/diceR")</span>
<span class="kw">library</span>(diceR)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(knitr)
<span class="kw">data</span>(hgsc)
dat &lt;-<span class="st"> </span><span class="kw">t</span>(hgsc[, -<span class="dv">1</span>])</code></pre></div>
<p>We load an expression data set from TCGA of 489 high grade serous carcinoma samples measured on 321 genes.</p>
</div>
<div id="consensus-clustering" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#consensus-clustering" class="anchor"> </a></body></html>Consensus Clustering</h2>
<p>When Monti et al. (2003) first introduced consensus clustering, the idea was to use one clustering algorithm on bootstrapped subsamples of the data. We implement some extensions where a consensus is reached across subsamples <em>and</em> across algorithms. The final cluster assignment is then computed using statistical transformations on the ensemble cluster.</p>
<p>The base function of this package is <code><a href="../reference/consensus_cluster.html">consensus_cluster()</a></code>, which outputs cluster assignments across subsamples and algorithms, for different k (number of clusters). For example, let’s say we were interested in clustering the <code>hgsc</code> data into 2, 3, or 4 clusters, using 80% resampling on 10 replicates, for these clustering algorithms: K-Means (Spearman distance), PAM (Spearman distance), Spectral Clustering using Radial-Basis kernel function, and Biclustering using a latent block model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_cluster.html">consensus_cluster</a></span>(dat, <span class="dt">nk =</span> <span class="dv">2</span>:<span class="dv">4</span>, <span class="dt">pItem =</span> <span class="fl">0.8</span>, <span class="dt">reps =</span> <span class="dv">10</span>, 
                        <span class="dt">algorithms =</span> <span class="kw">c</span>(<span class="st">"hc"</span>, <span class="st">"km"</span>, <span class="st">"pam"</span>, <span class="st">"block"</span>), <span class="dt">distance =</span> <span class="st">"spear"</span>)</code></pre></div>
<p>The output is a 4-dimensional array: rows are samples, columns are different bootstrap subsample replicates, slices are algorithms, and each “box” (4th dimension) is for a different k. Below are the first few cluster assignments for each replicate in the biclustering algorithm for k = 3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(CC)
<span class="co">#&gt;  num [1:489, 1:10, 1:4, 1:3] NA NA NA NA 1 1 1 NA 1 1 ...</span>
<span class="co">#&gt;  - attr(*, "dimnames")=List of 4</span>
<span class="co">#&gt;   ..$ : chr [1:489] "TCGA.04.1331_PRO.C5" "TCGA.04.1332_MES.C1" "TCGA.04.1336_DIF.C4" "TCGA.04.1337_MES.C1" ...</span>
<span class="co">#&gt;   ..$ : chr [1:10] "R1" "R2" "R3" "R4" ...</span>
<span class="co">#&gt;   ..$ : chr [1:4] "HC_Spear" "KM_Spear" "PAM_Spear" "BLOCK"</span>
<span class="co">#&gt;   ..$ : chr [1:3] "2" "3" "4"</span>
<span class="kw">kable</span>(<span class="kw">head</span>(CC[, , <span class="st">"BLOCK"</span>, <span class="st">"3"</span>]))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">R1</th>
<th align="right">R2</th>
<th align="right">R3</th>
<th align="right">R4</th>
<th align="right">R5</th>
<th align="right">R6</th>
<th align="right">R7</th>
<th align="right">R8</th>
<th align="right">R9</th>
<th align="right">R10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>TCGA.04.1331_PRO.C5</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>TCGA.04.1332_MES.C1</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>TCGA.04.1336_DIF.C4</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>TCGA.04.1337_MES.C1</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>TCGA.04.1338_MES.C1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>TCGA.04.1341_PRO.C5</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Note the unavoidable presence of <code>NA</code>s because we used 80% subsampling. This can be problematic in certain downstream ensemble methods, so we can impute missing values using K-Nearest Neighbours beforehand. There might still be <code>NA</code>s after KNN because of how the decision threshold was set. The remaining missing values can be imputed using majority voting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CC &lt;-<span class="st"> </span><span class="kw">apply</span>(CC, <span class="dv">2</span>:<span class="dv">4</span>, impute_knn, <span class="dt">data =</span> dat, <span class="dt">seed =</span> <span class="dv">1</span>)
CC_imputed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/impute_missing.html">impute_missing</a></span>(CC, dat, <span class="dt">nk =</span> <span class="dv">4</span>)
<span class="kw">sum</span>(<span class="kw">is.na</span>(CC))
<span class="co">#&gt; [1] 466</span>
<span class="kw">sum</span>(<span class="kw">is.na</span>(CC_imputed))
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>We can carry on the analysis using either <code>CC</code> or <code>CC_imputed</code>.</p>
</div>
<div id="consensus-functions" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#consensus-functions" class="anchor"> </a></body></html>Consensus Functions</h2>
<p><code>diceR</code> provides functions for retrieving useful summaries and other results for consensus clustering.</p>
<ul>
<li><a href="#compute-consensus-matrix-with-consensus_matrix"><code><a href="../reference/consensus_matrix.html">consensus_matrix()</a></code></a></li>
<li><a href="#combine-consensus-summaries-with-consensus_combine"><code><a href="../reference/consensus_combine.html">consensus_combine()</a></code></a></li>
<li><a href="#compare-algortihms-with-consensus_evaluate"><code><a href="../reference/consensus_combine.html">consensus_evaluate()</a></code></a></li>
<li><a href="#trim-and-reweigh-algorithms-with-consensus-trim"><code><a href="../reference/consensus_combine.html">consensus_trim()</a></code></a></li>
</ul>
<div id="compute-consensus-matrix-with-consensus_matrix" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#compute-consensus-matrix-with-consensus_matrix" class="anchor"> </a></body></html>Compute consensus matrix with <code><a href="../reference/consensus_matrix.html">consensus_matrix()</a></code>
</h3>
<p>The consensus matrix is an n by n matrix, where n is the number of samples. Each element is a real-valued number between 0 and 1 inclusive, representing the proportion of times that two samples were clustered together out of the times that the same samples were chosen in the bootstrap resampling. The diagonal are all one’s. Suppose we wanted to compute the consensus matrix for PAM only, and visualize using <code><a href="../reference/graphs.html">graph_heatmap()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pam<span class="fl">.2</span> &lt;-<span class="st"> </span>CC[, , <span class="st">"PAM_Spear"</span>, <span class="st">"2"</span>, drop =<span class="st"> </span><span class="ot">FALSE</span>]
cm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_matrix.html">consensus_matrix</a></span>(pam<span class="fl">.2</span>)
<span class="kw">dim</span>(cm)
<span class="co">#&gt; [1] 489 489</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/graphs.html">graph_heatmap</a></span>(pam<span class="fl">.2</span>)</code></pre></div>
<p><img src="overview_files/figure-html/graph_heatmap-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="combine-consensus-summaries-with-consensus_combine" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#combine-consensus-summaries-with-consensus_combine" class="anchor"> </a></body></html>Combine consensus summaries with <code><a href="../reference/consensus_combine.html">consensus_combine()</a></code>
</h3>
<p>If we wish to separately extract consensus matrices and consensus classes for every algorithm, <code><a href="../reference/consensus_combine.html">consensus_combine()</a></code> is a convenient wrapper to do so. Setting <code>element = "matrix"</code> returns a list of consensus matrices. On the other hand, setting <code>element = "class"</code> returns a matrix with rows as samples, and columns as clustering assignments for each algorithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ccomb_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_combine.html">consensus_combine</a></span>(CC, <span class="dt">element =</span> <span class="st">"matrix"</span>)
ccomb_class &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_combine.html">consensus_combine</a></span>(CC, <span class="dt">element =</span> <span class="st">"class"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(ccomb_matrix, <span class="dt">max.level =</span> <span class="dv">2</span>)
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ 2:List of 4</span>
<span class="co">#&gt;   ..$ HC_Spear : num [1:489, 1:489] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ KM_Spear : num [1:489, 1:489] 1 1 0.9 0 0 1 1 1 1 0.9 ...</span>
<span class="co">#&gt;   ..$ PAM_Spear: num [1:489, 1:489] 1 0.8 0.6 0.6 0.1 0.4 0.9 0.6 0.6 0.7 ...</span>
<span class="co">#&gt;   ..$ BLOCK    : num [1:489, 1:489] 1 1 0 1 1 0.1 1 1 0 0 ...</span>
<span class="co">#&gt;  $ 3:List of 4</span>
<span class="co">#&gt;   ..$ HC_Spear : num [1:489, 1:489] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ KM_Spear : num [1:489, 1:489] 1 0.9 0.7 0 0 1 1 0.875 0.9 0.5 ...</span>
<span class="co">#&gt;   ..$ PAM_Spear: num [1:489, 1:489] 1 1 0.889 0 0 ...</span>
<span class="co">#&gt;   ..$ BLOCK    : num [1:489, 1:489] 1 0.3 0 0 0 1 1 0.9 0.7 0 ...</span>
<span class="co">#&gt;  $ 4:List of 4</span>
<span class="co">#&gt;   ..$ HC_Spear : num [1:489, 1:489] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ KM_Spear : num [1:489, 1:489] 1 1 0.6 0 0 ...</span>
<span class="co">#&gt;   ..$ PAM_Spear: num [1:489, 1:489] 1 0.778 0.667 0.222 0 ...</span>
<span class="co">#&gt;   ..$ BLOCK    : num [1:489, 1:489] 1 0.111 0 0 0 ...</span>
<span class="kw">kable</span>(<span class="kw">head</span>(ccomb_class$<span class="st">`</span><span class="dt">4</span><span class="st">`</span>))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">HC_Spear</th>
<th align="right">KM_Spear</th>
<th align="right">PAM_Spear</th>
<th align="right">BLOCK</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>One can feed in <code>ccomb_class</code> into <code><a href="../reference/consensus_matrix.html">consensus_matrix()</a></code> to obtain a consensus matrix across both subsamples <strong>and</strong> algorithms.</p>
<p>A situation might also arise where we initially decided on using 4 clustering algorithms for the ensemble, but later wish to add additional algorithms for analysis. <code><a href="../reference/consensus_combine.html">consensus_combine()</a></code> takes in any number of ensemble objects (e.g. <code>CC</code> and <code>CC2</code>) and combines the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CC2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_cluster.html">consensus_cluster</a></span>(dat, <span class="dt">nk =</span> <span class="dv">2</span>:<span class="dv">4</span>, <span class="dt">reps =</span> <span class="dv">10</span>, <span class="dt">pItem =</span> <span class="fl">0.8</span>,
                         <span class="dt">algorithms =</span> <span class="st">"diana"</span>, <span class="dt">save =</span> <span class="ot">FALSE</span>)
ccomb_class2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_combine.html">consensus_combine</a></span>(CC, CC2, <span class="dt">element =</span> <span class="st">"class"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">head</span>(ccomb_class2$<span class="st">`</span><span class="dt">4</span><span class="st">`</span>))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">HC_Spear</th>
<th align="right">KM_Spear</th>
<th align="right">PAM_Spear</th>
<th align="right">BLOCK</th>
<th align="right">DIANA_Euclidean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="compare-algortihms-with-consensus_evaluate" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#compare-algortihms-with-consensus_evaluate" class="anchor"> </a></body></html>Compare algortihms with <code><a href="../reference/consensus_combine.html">consensus_evaluate()</a></code>
</h3>
<p>Internal cluster validation indices assess the performance of results by taking into account the compactness and separability of the clusters. We choose a variety of indices on which to compare the collection of clustering algorithms. We use the PAC (Proportion of Ambiguous Clusters), the proportion of entries in a consensus matrix that are strictly between <code>lower</code> (defaults to 0) and <code>upper</code> (defaults to 1), to give a measure of cluster stability. In addition, if no reference class is provided, we calculate the average PAC across algorithms within each <code>k</code>, and choose the <code>k</code> with the greatest average PAC. If there <em>is</em> a reference class, <code>k</code> is the number of distinct classes in the reference.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ccomp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_combine.html">consensus_evaluate</a></span>(dat, CC, CC2, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(ccomp$internal)</code></pre></div>
<table class="table"><tbody><tr>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">Algorithms</th>
<th align="right">c_index</th>
<th align="right">calinski_harabasz</th>
<th align="right">davies_bouldin</th>
<th align="right">dunn</th>
<th align="right">mcclain_rao</th>
<th align="right">pbm</th>
<th align="right">sd_dis</th>
<th align="right">ray_turi</th>
<th align="right">tau</th>
<th align="right">gamma</th>
<th align="right">g_plus</th>
<th align="right">silhouette</th>
<th align="right">s_dbw</th>
<th align="right">Compactness</th>
<th align="right">Connectivity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">HC_Spear</td>
<td align="right">0.5516903</td>
<td align="right">1.199420</td>
<td align="right">0.8947119</td>
<td align="right">0.4346364</td>
<td align="right">0.9382360</td>
<td align="right">98.730461</td>
<td align="right">0.1008726</td>
<td align="right">0.8286285</td>
<td align="right">0.0255108</td>
<td align="right">0.2826421</td>
<td align="right">0.0029220</td>
<td align="right">NaN</td>
<td align="right">0.5000006</td>
<td align="right">25.02390</td>
<td align="right">2.928968</td>
</tr>
<tr class="even">
<td align="left">KM_Spear</td>
<td align="right">0.4480542</td>
<td align="right">8.102332</td>
<td align="right">7.6243314</td>
<td align="right">0.2666956</td>
<td align="right">0.9668719</td>
<td align="right">5.471927</td>
<td align="right">0.4313450</td>
<td align="right">14.9405098</td>
<td align="right">0.0986108</td>
<td align="right">0.1394571</td>
<td align="right">0.2151346</td>
<td align="right">0.0249059</td>
<td align="right">NaN</td>
<td align="right">24.77038</td>
<td align="right">270.085317</td>
</tr>
<tr class="odd">
<td align="left">PAM_Spear</td>
<td align="right">0.4841708</td>
<td align="right">3.510465</td>
<td align="right">11.5566203</td>
<td align="right">0.2615316</td>
<td align="right">0.9899148</td>
<td align="right">2.354780</td>
<td align="right">0.6539747</td>
<td align="right">34.6644636</td>
<td align="right">0.0388279</td>
<td align="right">0.0549108</td>
<td align="right">0.2362737</td>
<td align="right">0.0106873</td>
<td align="right">NaN</td>
<td align="right">24.94227</td>
<td align="right">391.800397</td>
</tr>
<tr class="even">
<td align="left">BLOCK</td>
<td align="right">0.2644807</td>
<td align="right">83.729113</td>
<td align="right">2.3734705</td>
<td align="right">0.2609921</td>
<td align="right">0.8587794</td>
<td align="right">56.226689</td>
<td align="right">0.1442904</td>
<td align="right">1.4502934</td>
<td align="right">0.3145290</td>
<td align="right">0.4448094</td>
<td align="right">0.1387988</td>
<td align="right">0.1290880</td>
<td align="right">NaN</td>
<td align="right">23.24983</td>
<td align="right">255.562698</td>
</tr>
<tr class="odd">
<td align="left">DIANA_Euclidean</td>
<td align="right">0.2283060</td>
<td align="right">101.520151</td>
<td align="right">2.1508624</td>
<td align="right">0.3127262</td>
<td align="right">0.8387167</td>
<td align="right">68.327768</td>
<td align="right">0.1327705</td>
<td align="right">1.1908385</td>
<td align="right">0.3600726</td>
<td align="right">0.5092239</td>
<td align="right">0.1226920</td>
<td align="right">0.1515236</td>
<td align="right">NaN</td>
<td align="right">22.93711</td>
<td align="right">144.394048</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">Algorithms</th>
<th align="right">c_index</th>
<th align="right">calinski_harabasz</th>
<th align="right">davies_bouldin</th>
<th align="right">dunn</th>
<th align="right">mcclain_rao</th>
<th align="right">pbm</th>
<th align="right">sd_dis</th>
<th align="right">ray_turi</th>
<th align="right">tau</th>
<th align="right">gamma</th>
<th align="right">g_plus</th>
<th align="right">silhouette</th>
<th align="right">s_dbw</th>
<th align="right">Compactness</th>
<th align="right">Connectivity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">HC_Spear</td>
<td align="right">0.6627400</td>
<td align="right">0.9884433</td>
<td align="right">4.668260</td>
<td align="right">0.2962163</td>
<td align="right">1.0695984</td>
<td align="right">45.204808</td>
<td align="right">0.3080730</td>
<td align="right">7.570398</td>
<td align="right">-0.0397348</td>
<td align="right">-0.1693501</td>
<td align="right">0.0321874</td>
<td align="right">NaN</td>
<td align="right">0.554755</td>
<td align="right">25.01298</td>
<td align="right">32.87579</td>
</tr>
<tr class="even">
<td align="left">KM_Spear</td>
<td align="right">0.3860493</td>
<td align="right">9.8826807</td>
<td align="right">5.465131</td>
<td align="right">0.2462102</td>
<td align="right">0.9401596</td>
<td align="right">7.511457</td>
<td align="right">0.3445822</td>
<td align="right">10.993622</td>
<td align="right">0.1431398</td>
<td align="right">0.2102544</td>
<td align="right">0.1830156</td>
<td align="right">0.0072148</td>
<td align="right">NaN</td>
<td align="right">24.47740</td>
<td align="right">356.82659</td>
</tr>
<tr class="odd">
<td align="left">PAM_Spear</td>
<td align="right">0.4380780</td>
<td align="right">7.9660877</td>
<td align="right">6.102424</td>
<td align="right">0.2550387</td>
<td align="right">0.9754864</td>
<td align="right">4.411659</td>
<td align="right">0.3279148</td>
<td align="right">12.420838</td>
<td align="right">0.0628285</td>
<td align="right">0.0938050</td>
<td align="right">0.2032608</td>
<td align="right">0.0066019</td>
<td align="right">NaN</td>
<td align="right">24.61816</td>
<td align="right">449.38849</td>
</tr>
<tr class="even">
<td align="left">BLOCK</td>
<td align="right">0.2249674</td>
<td align="right">67.2248282</td>
<td align="right">3.191133</td>
<td align="right">0.2671491</td>
<td align="right">0.8439523</td>
<td align="right">59.832970</td>
<td align="right">0.2217584</td>
<td align="right">2.532256</td>
<td align="right">0.3298924</td>
<td align="right">0.4943632</td>
<td align="right">0.1125800</td>
<td align="right">0.0740507</td>
<td align="right">NaN</td>
<td align="right">22.31306</td>
<td align="right">311.17698</td>
</tr>
<tr class="odd">
<td align="left">DIANA_Euclidean</td>
<td align="right">0.2034680</td>
<td align="right">57.2564688</td>
<td align="right">1.606303</td>
<td align="right">0.3352598</td>
<td align="right">0.8260476</td>
<td align="right">71.903777</td>
<td align="right">0.1170323</td>
<td align="right">1.148836</td>
<td align="right">0.3887542</td>
<td align="right">0.5499627</td>
<td align="right">0.1124352</td>
<td align="right">0.1447351</td>
<td align="right">NaN</td>
<td align="right">22.74426</td>
<td align="right">147.49643</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">Algorithms</th>
<th align="right">c_index</th>
<th align="right">calinski_harabasz</th>
<th align="right">davies_bouldin</th>
<th align="right">dunn</th>
<th align="right">mcclain_rao</th>
<th align="right">pbm</th>
<th align="right">sd_dis</th>
<th align="right">ray_turi</th>
<th align="right">tau</th>
<th align="right">gamma</th>
<th align="right">g_plus</th>
<th align="right">silhouette</th>
<th align="right">s_dbw</th>
<th align="right">Compactness</th>
<th align="right">Connectivity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">HC_Spear</td>
<td align="right">0.6563183</td>
<td align="right">0.9357969</td>
<td align="right">5.058104</td>
<td align="right">0.2884723</td>
<td align="right">1.0710988</td>
<td align="right">26.337254</td>
<td align="right">0.4789073</td>
<td align="right">14.508819</td>
<td align="right">-0.0694037</td>
<td align="right">-0.1776517</td>
<td align="right">0.0898698</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
<td align="right">25.00136</td>
<td align="right">77.52183</td>
</tr>
<tr class="even">
<td align="left">KM_Spear</td>
<td align="right">0.3891924</td>
<td align="right">8.5081220</td>
<td align="right">4.948727</td>
<td align="right">0.2463400</td>
<td align="right">0.9515427</td>
<td align="right">5.982285</td>
<td align="right">0.6732226</td>
<td align="right">35.168019</td>
<td align="right">0.1112681</td>
<td align="right">0.1810387</td>
<td align="right">0.1546794</td>
<td align="right">-0.0132847</td>
<td align="right">NaN</td>
<td align="right">24.31766</td>
<td align="right">493.65833</td>
</tr>
<tr class="odd">
<td align="left">PAM_Spear</td>
<td align="right">0.4048818</td>
<td align="right">9.8546664</td>
<td align="right">4.209128</td>
<td align="right">0.2615316</td>
<td align="right">0.9614407</td>
<td align="right">6.528464</td>
<td align="right">0.5093436</td>
<td align="right">21.548792</td>
<td align="right">0.0805052</td>
<td align="right">0.1300469</td>
<td align="right">0.1666915</td>
<td align="right">0.0002378</td>
<td align="right">NaN</td>
<td align="right">24.32021</td>
<td align="right">560.22540</td>
</tr>
<tr class="even">
<td align="left">BLOCK</td>
<td align="right">0.1755757</td>
<td align="right">51.7429362</td>
<td align="right">2.978208</td>
<td align="right">0.2609921</td>
<td align="right">0.8152013</td>
<td align="right">39.783655</td>
<td align="right">0.2100927</td>
<td align="right">2.602966</td>
<td align="right">0.3755653</td>
<td align="right">0.6006883</td>
<td align="right">0.0780467</td>
<td align="right">0.0495859</td>
<td align="right">NaN</td>
<td align="right">21.92328</td>
<td align="right">351.61825</td>
</tr>
<tr class="odd">
<td align="left">DIANA_Euclidean</td>
<td align="right">0.2076213</td>
<td align="right">40.2421367</td>
<td align="right">1.606415</td>
<td align="right">0.3352598</td>
<td align="right">0.8292861</td>
<td align="right">47.212144</td>
<td align="right">0.1839914</td>
<td align="right">2.425901</td>
<td align="right">0.3792898</td>
<td align="right">0.5376238</td>
<td align="right">0.1150670</td>
<td align="right">0.0827677</td>
<td align="right">NaN</td>
<td align="right">22.64088</td>
<td align="right">179.73413</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody></table>
<p>We see that the biclustering algorithm is the least ambiguous and also most well-clustered (high compactness and separability).</p>
</div>
<div id="trim-and-reweigh-algorithms-with-consensus_trim" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#trim-and-reweigh-algorithms-with-consensus_trim" class="anchor"> </a></body></html>Trim and reweigh algorithms with <code><a href="../reference/consensus_combine.html">consensus_trim()</a></code>
</h3>
<p>Some algorithms perform too poorly to deserve membership in the cluster ensemble. We consider the relative ranks of each algorithm across all internal indices, and compute their sum. All algorithms below a certain quantile for the sum rank are trimmed (removed). By default this quantile is 75%.</p>
<p>After trimming, we can optionally choose to reweigh the algorithms based on the internal index magnitudes. Of course, we take into account the direction of optimality (higher is better is lower is better). Algorithms reweighed are then fed into the consensus functions. This is done by replicating each algorithm by a scalar factor that is proportional to its weight. For example, if we have two algorithms A and B, and A is given a weight of 80% and B is given a weight of 20%, then we make 4 copies of A and 1 copy of B. To minimize computational time, the total number of copies out of all algorithms has an upper bound of 100. Without reweighing, each algorithm is given equal weight.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ctrim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_combine.html">consensus_trim</a></span>(dat, CC, CC2)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(ctrim, <span class="dt">max.level =</span> <span class="dv">2</span>)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ alg.keep  : chr [1:3] "HC_Spear" "BLOCK" "DIANA_Euclidean"</span>
<span class="co">#&gt;  $ alg.remove: chr [1:2] "KM_Spear" "PAM_Spear"</span>
<span class="co">#&gt;  $ eval      :List of 3</span>
<span class="co">#&gt;   ..$ k       : int 2</span>
<span class="co">#&gt;   ..$ pac     :'data.frame': 3 obs. of  6 variables:</span>
<span class="co">#&gt;   ..$ internal:List of 3</span>
<span class="co">#&gt;  $ data.new  : num [1:489, 1:10, 1:3, 1] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 4</span></code></pre></div>
<p>The return value shows which algorithms were kept, removed (if any), and the trimmed (and potentially reweighed) cluster ensemble.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#consensus-clustering">Consensus Clustering</a></li>
      <li><a href="#consensus-functions">Consensus Functions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Derek Chiu, Aline Talhouk, Johnson Liu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
